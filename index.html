<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠</title>
<style>
/* --- ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô --- */
body { 
  font-family: "Tahoma", sans-serif; 
  background:#f5f6fa; 
  margin:0; 
  padding:0; 
  display:flex; 
  justify-content:center; 
  min-height:100vh;
  transition: background 0.3s, color 0.3s;
}
.container { 
  width:100%; 
  max-width:650px; 
  background:#fff; 
  padding:20px; 
  border-radius:16px; 
  box-shadow:0 6px 20px rgba(0,0,0,0.15); 
  box-sizing:border-box; 
  margin:20px;
  display:flex;
  flex-direction:column;
  position:relative;
  transition: all 0.3s ease;
}

/* --- ‡∏õ‡∏∏‡πà‡∏° Toggle Theme --- */
.theme-toggle {
  position: absolute;
  top: 12px;
  right: 12px;
  width: 48px;
  height: 48px;
  background: #007bff;
  color: #fff;
  border: none;
  border-radius: 50%;
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s, background 0.3s;
}
.theme-toggle:hover { 
  background: #0056b3; 
  transform: rotate(20deg);
}

/* --- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ + ‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° --- */
.header-display {
  text-align:center; 
  margin-bottom:20px; 
}
.header-display img { width:100px; margin-bottom:8px; max-width:100%; height:auto; transition: transform 0.3s; }
.header-display:hover img { transform: rotate(-5deg); }
.header-display h2, .header-display h3 { margin:5px 0; color:#555; font-size:1rem; }

/* --- ‡∏ü‡∏≠‡∏£‡πå‡∏° --- */
.input-group { margin-bottom:15px; transition: transform 0.2s;}
.input-group label { display:block; margin-bottom:4px; font-weight:bold; }
.input-group input {
  width:100%;
  padding:14px;
  border:1px solid #ccc;
  border-radius:12px;
  font-size:16px;
  text-align:left;
  box-sizing:border-box;
  transition: all 0.3s;
}
.input-group input:focus{
  border-color:#007bff;
  box-shadow:0 0 10px rgba(0,123,255,0.3);
}
#memberId, #fullName { text-align:left; }  
input.red { color:red; font-weight:bold; }

button { 
  width:100%;
  padding:14px; 
  font-size:18px; 
  border:none; 
  border-radius:12px; 
  cursor:pointer; 
  margin-top:12px; 
  transition: all 0.3s;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
#calcBtn { background:#007bff; color:white; }
#calcBtn:disabled { background:#ccc; cursor:not-allowed; box-shadow:none;}
#calcBtn:hover:not(:disabled){ transform: translateY(-2px);}
#printBtn { background:#28a745; color:white; display:none; }
#printBtn:hover{ transform: translateY(-2px); }

/* --- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• --- */
.result-wrapper { display:none; margin-top:20px; flex-direction:column; }
.result { 
  background:#f9f9f9; 
  padding:20px; 
  border-radius:16px; 
  border:1px solid #ddd; 
  font-size:16px; 
  line-height:1.6; 
  width:100%;
  overflow:auto;
  transition: all 0.3s;
}
.result h3 { text-align:center; margin-top:0; color:#007bff;}
.result p { margin:5px 0; }
.result .highlight { font-weight:bold; color:#d9534f; }
.result table{width:100%; border-collapse: collapse; margin-top:10px;}
.result table td{padding:6px 8px; border-bottom:1px dashed #ccc;}

p.gray { font-size:13px; color:gray; margin:4px 0; }
p.warning { color:red; font-weight:bold; display:none; margin:4px 0; }

.status-bar { width:100%; background-color:#eee; border-radius:12px; height:24px; margin:10px 0; overflow:hidden; }
.status-fill { height:100%; border-radius:12px; transition: width 1s ease, background-color 0.5s; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; font-size:14px; }

/* --- Print Mode (A4, ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤, ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£) --- */
.print-header { display:none; }
@media print {
  body, .container { 
    width: 210mm; 
    height: 297mm; 
    max-width: 210mm; 
    max-height: 297mm; 
    background: #fff; 
    padding: 15mm; 
    margin: 0; 
    font-size: 14px; 
    line-height: 1.4; 
    display: block; 
  }
  #formSection { display:none !important; }
  .theme-toggle, .header-display { display:none !important; }
  .print-header { display:block; text-align:center; margin-bottom:20px; }
  .print-header img { width:80px; margin-bottom:5px; }
  .print-header h2, .print-header h3 { margin:2px 0; font-size:14px; }
  .result table td{border:none; padding:4px 2px;}
}

/* --- Responsive ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ --- */
@media (max-width:600px){
  body { background:#eaeaea; display:block; padding:10px;}
  .container { margin:0; padding:18px 12px; border-radius:16px; box-shadow:0 6px 18px rgba(0,0,0,0.1);}
  .header-display img { width:80px; }
  .header-display h2, .header-display h3 { font-size:1rem; }
  input { font-size:16px; padding:12px; border-radius:12px;}
  button { font-size:16px; padding:14px; border-radius:14px;}
  .result { font-size:15px; padding:18px; line-height:1.5; border-radius:14px;}
  .status-bar { height:22px; border-radius:14px;}
  .status-fill { font-size:13px;}
}

/* --- Dark Mode --- */
body.dark { background:#121212; color:#eee; }
body.dark .container { background:#1e1e1e; box-shadow:none; }
body.dark .header-display h2, body.dark .header-display h3 { color:#ddd; }
body.dark .input-group input { background:#2a2a2a; border:1px solid #444; color:#eee; }
body.dark .result { background:#2a2a2a; border:1px solid #444; color:#ddd; }
body.dark .status-bar { background:#444; }
body.dark .status-fill { color:#fff; }
</style>
</head>
<body>
<div class="container">

  <button class="theme-toggle" onclick="toggleTheme()">üåô</button>

  <div class="header-display">
    <img src="https://www.chainattsc.com/mediafiles/coop/logo/logo300.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå">
    <h3>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠ (‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á)</h3>
    <h2>‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏Ñ‡∏£‡∏π‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î</h2>
  </div>

  <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏° -->
  <div id="formSection">
    <div class="input-group">
      <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (6 ‡∏´‡∏•‡∏±‡∏Å)</label>
      <input id="memberId" type="text" maxlength="6" placeholder="‡πÄ‡∏ä‡πà‡∏ô 009080">
    </div>
    <div class="input-group">
      <label>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input id="fullName" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
    </div>
    <div class="input-group">
      <label>‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ</label>
      <input id="loanAmount" type="text" value="0">
    </div>
    <div class="input-group">
      <label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ (‡∏ï‡πà‡∏≠‡∏õ‡∏µ)</label>
      <input id="interestRate" type="text" value="5">
    </div>
    <div class="input-group">
      <label>‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
      <input id="monthlyPrincipal" type="text" value="0">
    </div>
    <div class="input-group">
      <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 240)</label>
      <input id="installments" type="text" readonly>
      <p class="gray">* ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 240 ‡∏á‡∏ß‡∏î</p>
      <p id="warningMsg" class="warning">‚ùå ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡πÄ‡∏Å‡∏¥‡∏ô 240 ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ</p>
    </div>
    <div class="input-group">
      <label>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
      <input id="income" type="text" value="0">
    </div>
    <div class="input-group">
      <label>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
      <input id="expense" type="text" value="0">
    </div>

    <button id="calcBtn" onclick="calculateLoan()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
    <button id="printBtn" onclick="window.print()">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
  </div>

  <!-- Print Header -->
  <div class="print-header">
    <img src="https://www.chainattsc.com/mediafiles/coop/logo/logo300.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå">
    <h2>‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏Ñ‡∏£‡∏π‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î</h2>
    <h3>248 ‡∏´‡∏°‡∏π‡πà 5 ‡∏ñ‡∏ô‡∏ô‡∏û‡∏´‡∏•‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô ‡∏ï‡∏≥‡∏ö‡∏•‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡∏•‡πâ‡∏ß‡∏¢ ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó 17000</h3>
    <h3>‡πÇ‡∏ó‡∏£: 056-411412 ‡∏ï‡πà‡∏≠ 12 ‡∏´‡∏£‡∏∑‡∏≠ 099-270-0439 (‡∏ù‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠)</h3>
    <h3>www.chainattsc.com, Line Official ID : @ctsc</h3>
  </div>

  <!-- Result -->
  <div class="result-wrapper">
    <div class="result" id="resultDiv"></div>
  </div>
</div>

<script>
// Toggle Theme
function toggleTheme(){
  const body=document.body;
  const btn=document.querySelector(".theme-toggle");
  body.classList.toggle("dark");
  btn.textContent = body.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";
  localStorage.setItem("theme", body.classList.contains("dark") ? "dark" : "light");
}
(function(){
  const saved=localStorage.getItem("theme");
  const prefersDark=window.matchMedia("(prefers-color-scheme: dark)").matches;
  if(saved==="dark" || (!saved && prefersDark)){
    document.body.classList.add("dark");
    document.querySelector(".theme-toggle").textContent="‚òÄÔ∏è";
  }
})();

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
function formatMemberId(){ 
  const input=document.getElementById("memberId");
  let v=input.value.replace(/\D/g,"");
  if(v.length>0) v=v.padStart(6,"0");
  input.value=v;
}
document.getElementById("memberId").addEventListener("blur",formatMemberId);
document.getElementById("memberId").addEventListener("keypress", e=>{if(e.key==="Enter") formatMemberId();});
function formatNumber(value){return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");}
function parseNumber(value){return parseInt(value.replace(/,/g,''))||0;}
function updateMonthlyPrincipal(){
  const loan=parseNumber(document.getElementById('loanAmount').value);
  const mpInput=document.getElementById('monthlyPrincipal');
  const instInput=document.getElementById('installments');
  const warn=document.getElementById('warningMsg');
  let mp=parseNumber(mpInput.value);
  if(mp<=0) return;
  mp=Math.round(mp);
  mpInput.value=formatNumber(mp);
  const ci=Math.ceil(loan/mp);
  instInput.value=formatNumber(ci);
  if(ci>240){document.getElementById('calcBtn').disabled=true; warn.style.display='block'; instInput.classList.add('red');} 
  else{document.getElementById('calcBtn').disabled=false; warn.style.display='none'; instInput.classList.remove('red');}
}
['loanAmount','income','expense','monthlyPrincipal','interestRate'].forEach(id=>
  document.getElementById(id).addEventListener('input', e=>{
    let v=parseInt(e.target.value.replace(/,/g,''))||0;
    e.target.value=formatNumber(v);
    if(id==='loanAmount'||id==='monthlyPrincipal') updateMonthlyPrincipal();
  })
);

function calculateLoan(){
  const memberId=document.getElementById('memberId').value||"-";
  const fullName=document.getElementById('fullName').value||"-";
  const loan=parseNumber(document.getElementById('loanAmount').value);
  const rate=parseNumber(document.getElementById('interestRate').value);
  const income=parseNumber(document.getElementById('income').value);
  const expense=parseNumber(document.getElementById('expense').value);
  let mp=parseNumber(document.getElementById('monthlyPrincipal').value);
  if(mp<=0) mp=Math.round(loan/150);
  const ci=Math.ceil(loan/mp);
  if(ci>240) return;
  document.getElementById('installments').value=formatNumber(ci);

  let bal=loan, totInt=0, actualI=0;
  for(let i=0;i<ci;i++){
    const interest=Math.round((bal*(rate/100)*30)/365);
    const prin=Math.min(mp,bal);
    bal-=prin;
    totInt+=interest;
    actualI++;
    if(bal<=0) break;
  }

  const interest31=Math.round((loan*(rate/100)*31)/365);
  const net=income-expense-(mp+Math.round(totInt/actualI));
  const pct=income>0?(net/income)*100:0;
  const minRemain=Math.round(income*0.3);
  const ok=net>=minRemain;

  const result=document.getElementById('resultDiv');
  result.innerHTML=`
    <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h3>
    <table>
      <tr><td>‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</td><td class="highlight">${memberId}</td></tr>
      <tr><td>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</td><td>${fullName}</td></tr>
      <tr><td>‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ</td><td class="highlight">${formatNumber(loan)} ‡∏ö‡∏≤‡∏ó</td></tr>
      <tr><td>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á</td><td class="highlight">${formatNumber(ci)} ‡∏á‡∏ß‡∏î</td></tr>
      <tr><td>‡∏™‡πà‡∏á‡∏ï‡πâ‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</td><td class="highlight">${formatNumber(mp)} ‡∏ö‡∏≤‡∏ó</td></tr>
      <tr><td>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (31 ‡∏ß‡∏±‡∏ô)</td><td class="highlight">${formatNumber(interest31)} ‡∏ö‡∏≤‡∏ó</td></tr>
      <tr><td>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</td><td class="highlight">${formatNumber(income)} ‡∏ö‡∏≤‡∏ó</td></tr>
      <tr><td>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</td><td class="highlight">${formatNumber(expense)} ‡∏ö‡∏≤‡∏ó</td></tr>
      <tr><td>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</td><td class="highlight">${formatNumber(net)} ‡∏ö‡∏≤‡∏ó (${pct.toFixed(2)}%)</td></tr>
      <tr><td>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</td><td style="color:${ok?'green':'red'}; font-weight:bold;">${ok?'‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå':'‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå (‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ù‡πà‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠)'}</td></tr>
      <tr><td>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ 30%</td><td class="highlight">${formatNumber(minRemain)} ‡∏ö‡∏≤‡∏ó</td></tr>
    </table>
    <div class="status-bar">
      <div class="status-fill" style="width:${Math.max(0,Math.min(100,pct))}%; background-color:${ok?'green':'red'}">${pct.toFixed(2)}%</div>
    </div>
    <p><b>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</b> ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
  `;
  document.querySelector('.result-wrapper').style.display='block';
  document.getElementById('printBtn').style.display='block';
}
</script>
</body>
</html>
